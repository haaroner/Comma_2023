#include "project_config.h"
#include "pin_setup.h"
#include "time_service.h"
#include "robot_math.h"

int _cur_speed = 300, change_speed_const = 1;
uint32_t _cur_time = 0;

int change_speed(int _speed, uint32_t _time)
{
  if(my_abs(_speed - _cur_speed) < change_speed_const )
    _cur_speed = _speed;
  else
  {
    if(_cur_time != _time)
    {
      _cur_speed = _cur_speed + my_sgn(_speed - _cur_speed) * change_speed_const;
      _cur_time = _time;
    }
  }
  if(_cur_speed > 350) _cur_speed = 350;
  else if(_cur_speed < 250) _cur_speed = 250;
  return _cur_speed;
}
